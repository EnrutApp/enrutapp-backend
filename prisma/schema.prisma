generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model Usuarios {
  idUsuario            String    @id @db.VarChar(36)
  idRol                String    @db.VarChar(36)
  foto                 String?
  tipoDoc              String    @db.VarChar(36)
  numDocumento         String    @unique @db.VarChar(20)
  nombre               String    @db.VarChar(100)
  telefono             String    @db.VarChar(20)
  correo               String    @unique @db.VarChar(100)
  contrasena           String    @db.VarChar(255)
  direccion            String    @db.VarChar(255)
  idCiudad             Int
  estado               Boolean
  resetPasswordCode    String?   @db.VarChar(100)
  resetPasswordExpires DateTime?

  rol           Roles    @relation(fields: [idRol], references: [idRol])
  tipoDocumento TiposDoc @relation(fields: [tipoDoc], references: [idTipoDoc])
  ciudad        Ciudades @relation(fields: [idCiudad], references: [idCiudad])

  conductores      Conductores[]
  reservasPrivadas ReservasPrivadas[]

  @@map("Usuarios")
}

model Ciudades {
  idCiudad     Int        @id @default(autoincrement())
  nombreCiudad String     @unique @db.VarChar(100)
  usuarios     Usuarios[]

  @@map("Ciudades")
}

model Roles {
  idRol       String  @id @db.VarChar(36)
  nombreRol   String  @unique @db.VarChar(50)
  descripcion String? @db.Text
  estado      Boolean

  usuarios Usuarios[]

  @@map("Roles")
}

model TiposDoc {
  idTipoDoc     String @id @db.VarChar(36)
  nombreTipoDoc String @unique @db.VarChar(50)

  usuarios Usuarios[]

  @@map("TiposDoc")
}

model TiposVehiculo {
  idTipoVehiculo     String   @id @db.VarChar(36)
  nombreTipoVehiculo String   @unique @db.VarChar(50)
  descripcion        String?  @db.Text
  estado             Boolean  @default(true)
  createdAt          DateTime @default(now())
  updatedAt          DateTime @updatedAt

  vehiculos Vehiculos[]

  @@map("TiposVehiculo")
}

model MarcasVehiculos {
  idMarcaVehiculo String   @id @db.VarChar(36)
  nombreMarca     String   @unique @db.VarChar(50)
  pais            String?  @db.VarChar(50)
  estado          Boolean  @default(true)
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt

  vehiculos Vehiculos[]

  @@map("MarcasVehiculos")
}

model Vehiculos {
  idVehiculo               String    @id @db.VarChar(36)
  idTipoVehiculo           String    @db.VarChar(36)
  idMarcaVehiculo          String    @db.VarChar(36)
  placa                    String    @unique @db.VarChar(10)
  linea                    String    @db.VarChar(50)
  modelo                   Int
  color                    String    @db.VarChar(30)
  vin                      String?   @unique @db.VarChar(17)
  fotoUrl                  String    @db.VarChar(255)
  capacidadPasajeros       Int
  capacidadCarga           Decimal?  @db.Decimal(10, 2)
  soatVencimiento          DateTime?
  tecnomecanicaVencimiento DateTime?
  seguroVencimiento        DateTime?
  estado                   Boolean   @default(true)
  createdAt                DateTime  @default(now())
  updatedAt                DateTime  @updatedAt

  tipoVehiculo  TiposVehiculo   @relation(fields: [idTipoVehiculo], references: [idTipoVehiculo])
  marcaVehiculo MarcasVehiculos @relation(fields: [idMarcaVehiculo], references: [idMarcaVehiculo])

  reservasPrivadas ReservasPrivadas[]

  @@map("Vehiculos")
}

model Ubicacion {
  idUbicacion     String   @id @default(uuid()) @db.VarChar(36)
  nombreUbicacion String   @db.VarChar(100)
  direccion       String   @db.VarChar(255)
  latitud         Decimal? @db.Decimal(10, 8)
  longitud        Decimal? @db.Decimal(11, 8)

  origenes Origen[]
  destinos Destino[]

  @@map("Ubicacion")
}

model Origen {
  idOrigen    String  @id @default(uuid()) @db.VarChar(36)
  idUbicacion String  @db.VarChar(36)
  descripcion String? @db.VarChar(255)

  ubicacion   Ubicacion @relation(fields: [idUbicacion], references: [idUbicacion])
  rutasOrigen Ruta[]    @relation("RutasDesdeOrigen")

  @@map("Origen")
}

model Destino {
  idDestino   String  @id @default(uuid()) @db.VarChar(36)
  idUbicacion String  @db.VarChar(36)
  descripcion String? @db.VarChar(255)

  ubicacion    Ubicacion @relation(fields: [idUbicacion], references: [idUbicacion])
  rutasDestino Ruta[]    @relation("RutasHaciaDestino")

  @@map("Destino")
}

model Ruta {
  idRuta         String   @id @default(uuid()) @db.VarChar(36)
  idOrigen       String   @db.VarChar(36)
  idDestino      String   @db.VarChar(36)
  distancia      Decimal? @db.Decimal(10, 2)
  observaciones  String?  @db.VarChar(100)
  tiempoEstimado String?  @db.VarChar(10)
  precioBase     Decimal? @db.Decimal(10, 2)
  estado         String?  @db.VarChar(50)

  origen  Origen  @relation("RutasDesdeOrigen", fields: [idOrigen], references: [idOrigen])
  destino Destino @relation("RutasHaciaDestino", fields: [idDestino], references: [idDestino])

  reservasPrivadas ReservasPrivadas[]

  @@map("Ruta")
}

model MetodoPago {
  idMetodoPago String @id @db.VarChar(36)
  nombreMetodo String @db.VarChar(50)

  reservasPrivadas ReservasPrivadas[]

  @@map("MetodoPago")
}

model Conductores {
  idConductor              String   @id @db.VarChar(36)
  idUsuario                String   @db.VarChar(36)
  licencia                 String   @db.VarChar(50)
  categoriaLicencia        String   @db.VarChar(20)
  fechaVencimientoLicencia DateTime
  idArl                    String?  @db.VarChar(36)
  idEps                    String?  @db.VarChar(36)
  fondoPensiones           String?  @db.VarChar(50)
  estado                   Boolean

  usuario          Usuarios           @relation(fields: [idUsuario], references: [idUsuario])
  reservasPrivadas ReservasPrivadas[]

  @@map("Conductores")
}

model ReservasPrivadas {
  idReservaPrivada String   @id @default(uuid()) @db.VarChar(36)
  idUsuario        String   @db.VarChar(36)
  idVehiculo       String?  @db.VarChar(36)
  idConductor      String?  @db.VarChar(36)
  idRuta           String   @db.VarChar(36)
  fecha            DateTime
  horaSalida       String   @db.VarChar(10)
  cantidadPersonas Int
  precioTotal      Decimal? @db.Decimal(10, 2)
  idMetodoPago     String   @db.VarChar(36)
  estadoReserva    String   @db.VarChar(50)
  fechaReserva     DateTime

  usuario    Usuarios     @relation(fields: [idUsuario], references: [idUsuario])
  vehiculo   Vehiculos?   @relation(fields: [idVehiculo], references: [idVehiculo])
  conductor  Conductores? @relation(fields: [idConductor], references: [idConductor])
  ruta       Ruta         @relation(fields: [idRuta], references: [idRuta])
  metodoPago MetodoPago   @relation(fields: [idMetodoPago], references: [idMetodoPago])

  detalles DetalleReservaPrivadaPasajero[]

  @@map("ReservasPrivadas")
}

model DetalleReservaPrivadaPasajero {
  idDetalle        String @id @default(uuid()) @db.VarChar(36)
  idReservaPrivada String @db.VarChar(36)
  nombrePasajero   String @db.VarChar(100)
  tipoDoc          String @db.VarChar(36)
  numDocPasajero   String @db.VarChar(20)
  edadPasajero     Int

  reserva ReservasPrivadas @relation(fields: [idReservaPrivada], references: [idReservaPrivada])

  @@map("DetalleReservaPrivadaPasajero")
}